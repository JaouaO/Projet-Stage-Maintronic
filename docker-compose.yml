version: '3.8'

services: 

  mysql: 

    image: mysql:5.7 

    container_name: mysql-server 

    environment: 

      MYSQL_ROOT_PASSWORD: secret 

      MYSQL_DATABASE: mydb 

      MYSQL_USER: userdb 

      MYSQL_PASSWORD: secret 

    ports: 

      - "3307:3306" 

    volumes: 

      - ./mysql/data:/var/lib/mysql 

    networks: 

      - mynet 

 

  phpmyadmin: 

    image: phpmyadmin/phpmyadmin 

    container_name: phpmyadmin 

    environment: 

      PMA_HOST: mysql-server 

      PMA_USER: userdb 

      PMA_PASSWORD: secret
    ports:
      - "8080:80"

    networks: 

      - mynet 

 

  php72: 

    build: ./php72 

    container_name: php72 

    volumes: 

      - ./php72:/var/www/html 

    networks: 

      - mynet 

 

  nginx: 

    image: nginx:alpine 

    container_name: nginx 

    ports: 

      - "80:80" 

    volumes: 

      - ./nginx/default.conf:/etc/nginx/conf.d/default.conf:ro 

    depends_on: 

      - phpmyadmin 

      - php72 

    networks: 

      - mynet 

 

networks: 

  mynet: 

    driver: bridge 